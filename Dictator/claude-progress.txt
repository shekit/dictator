
## 2026-01-21 - Hybrid Onboarding UX Implementation

**Problem**: User reported that closing onboarding without completing left no way to re-access it until app restart.

**User Request**: "if i launch the dictator app for the first time and then before setting it up, close the onboarding, then there is no way for me to set it up again. the onboarding doesnt trigger the next i double click it until i quit the app from the menu bar"

**Solution Chosen**: Option 3 (Hybrid Approach)
1. Auto-show onboarding on launch if incomplete (up to 3 times)
2. Add "Complete Setup..." menu item for manual access  
3. After 3 dismissals, stop auto-showing but keep menu item available

**Implementation**:
- Added onboardingDismissalCount tracking in UserDefaults
- Modified AppDelegate launch logic to check dismissal count
- Auto-show onboarding only if dismissalCount < 3 OR has in-progress step
- Made showOnboarding() public for menu access
- Added NSWindowDelegate to track window closures
- Increments dismissalCount when window closed without completion
- Initializes services even if onboarding incomplete (so app remains usable)
- Added "Complete Setup..." menu item to StatusBarController
- Menu item only appears when onboarding is not complete
- Added setOnboardingComplete() to update menu visibility

**Testing**: Build successful. Ready for user testing.

**Commit**: 8b8e921 - Implement hybrid onboarding UX with dismissal tracking


## 2026-01-21 - Simplified Onboarding UX

**User Feedback**: "I think we can simplify this, there don't need to be like three dismissals before you stop showing, just always show it till the onboarding has been completed."

**Change**: Removed dismissal count tracking complexity. New simpler behavior:
- Always auto-show onboarding on launch if not completed (no dismissal limit)
- "Complete Setup..." menu item always available if not completed
- User can dismiss and re-launch, onboarding will always show again
- Services initialize even if onboarding dismissed (app remains usable)

**Code changes**:
- Removed onboardingDismissalCount UserDefaults tracking
- Simplified launch logic to just check hasCompletedOnboarding boolean
- Removed dismissal count increment logic from windowWillClose
- Kept manual "Complete Setup..." menu item access

**Result**: Much simpler and more predictable UX. Onboarding always shows until completed, with optional manual access via menu.

**Commit**: 461ac5b - Simplify onboarding UX - always auto-show until complete


## 2026-01-21 - Add fn key label to onboarding

**User Feedback**: "on the first onboarding page where you have that large FN key in blue, that icon doesn't really look like a key. So, just to clarify that it's a key, maybe put a small text under FN, where it says FN, just put FN key as a small text"

**Implementation**: Added small caption text "fn key" directly under the large fn button graphic to clarify it's a keyboard key.

**Code changes**:
- Wrapped fn button ZStack in a VStack with 4pt spacing
- Added Text("fn key") with .caption font and .secondary color
- Maintains visual hierarchy while adding clarity

**Commit**: 50392a3 - Add 'fn key' label to clarify keyboard key on onboarding


## 2026-01-21 - Fix menu bar dropdown not showing

**User Report**: "this is very broken now, if i quit the app without completing the onboarding and click the icon in the menu bar, the menu dropdown doesnt show"

**Root Cause**: During earlier refactoring, we removed `statusItem.menu = menu` assignment. The menu was being built correctly but never assigned to the status item, so clicking the icon showed nothing.

**Fix**: Added `statusItem.menu = menu` in `configureMenu()` after building the initial menu structure.

**Commit**: cba6622 - Fix menu bar dropdown not showing


## 2026-01-21 - Fix onboarding UX issues

**User Report**: 
1. "if i quit the onboarding midway, then i dont see the continue setup button in the menu dropdown and there is no way to retrigger it"
2. "if the onboarding is quit before its completed, quit the app also. right now the icon stays in the menu bar, it shouldnt"

**Root Causes**:

1. **Missing "Complete Setup..." menu item**:
   - `updateLLMMenuItems()` was rebuilding menu from scratch without checking `isOnboardingComplete`
   - When user dismissed onboarding, services initialized anyway
   - Service initialization triggered observers that called `updateLLMMenuItems()`
   - This overwrote the correct menu (which had "Complete Setup...") with incomplete menu
   - User was stuck with no way to re-open onboarding

2. **App not quitting when onboarding dismissed**:
   - `windowWillClose` was calling `initializeServices()` even when onboarding incomplete
   - App stayed running with menu bar icon visible
   - User expected app to quit entirely

**Solutions**:

1. Changed `updateLLMMenuItems()` to call `updateMenuForOnboardingStatus()` instead of building menu directly
   - This ensures onboarding status is always checked when rebuilding menu
   - "Complete Setup..." menu item now persists correctly

2. Changed `windowWillClose` to call `NSApp.terminate(nil)` when onboarding incomplete
   - App now quits cleanly with no menu bar icon remaining
   - Next launch will show onboarding again

**Commit**: 2c0300e - Fix onboarding UX: preserve Complete Setup menu item and quit on dismissal

